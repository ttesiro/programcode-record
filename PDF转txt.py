#coding:utf-8
import pandas as pd
import pdfplumber
import re
import os

path = '/Users/bytedance/Documents/年报/深交所-年报'  # 自己存放pdf的文件夹名称（需更改为自己的）
files = os.listdir(path)
#pdfList = [f for f in files if f.endswith(('pdf'))]
#print(pdfList)
pdfList = ['山河药辅：2019年度社会责任报告-2020年年度报告.pdf', '海鸥住工：2019年度社会责任报告-2020年年度报告.pdf', '嘉事堂：2019年企业社会责任报告-2020年年度报告.pdf', '漳州发展：社会责任报告-2021年年度报告.pdf', '新 希 望：2019年度社会责任报告-2020年年度报告.pdf', '中国长城：2019年度社会责任报告-2020年年度报告.pdf', '凯恩股份：社会责任报告-2021年年度报告.pdf', '苏宁环球：2019年度社会责任报告-2020年年度报告.pdf', '博腾股份：2019年社会责任报告-2020年年度报告.pdf', '软控股份：2019年度社会责任报告-2020年年度报告.pdf', '恩捷股份：社会责任报告-2021年年度报告.pdf', '北方华创：2019年社会责任报告-2020年年度报告.pdf', '飞利信：2019年度社会责任报告-2020年年度报告.pdf', 'ST东电：2020年社会责任报告-2021年年度报告.pdf', '新宙邦：《公司2020年度社会责任报告》-2021年年度报告.pdf', '汉威科技：2019年度社会责任报告-2020年年度报告.pdf', '分众传媒：2019年度社会责任报告-2020年年度报告.pdf', '兴业科技：2019年度社会责任报告-2020年年度报告.pdf', '苏宁易购：2019社会责任报告-2020年年度报告.pdf', '太阳电缆：社会责任报告-2021年年度报告.pdf', '江阴银行：2019年度社会责任报告-2020年年度报告.pdf', '金 融 街：社会责任报告-2021年年度报告.pdf', '芒果超媒：芒果超媒股份有限公司2020年度社会责任报告（英文版）-2021年年度报告.pdf', '南  玻Ａ：2019年度社会责任报告-2020年年度报告.pdf', '鹏鼎控股：社会责任报告-2021年年度报告.pdf', '信维通信：2019年度社会责任报告-2020年年度报告.pdf', '三聚环保：2019年社会责任报告-2020年年度报告.pdf', '鲁  泰Ａ：社会责任报告-2021年年度报告.pdf', '索菲亚：社会责任报告-2021年年度报告.pdf', '凯撒旅业：2019社会责任报告-2020年年度报告.pdf', '安泰科技：2019年度社会责任报告-2020年年度报告.pdf', '山西证券：社会责任报告-2021年年度报告.pdf', '长春高新：2019年度社会责任报告-2020年年度报告.pdf', '启迪环境：2019年度社会责任报告-2020年年度报告.pdf', 'ST冠福：2019年度社会责任报告-2020年年度报告.pdf', '歌尔股份：社会责任报告-2021年年度报告.pdf', '神州泰岳：2020年度社会责任报告-2021年年度报告.pdf', '金力永磁：2019年度社会责任报告-2020年年度报告.pdf', '宏川智慧：2019年度社会责任报告-2020年年度报告.pdf', '中航光电：社会责任报告-2021年年度报告.pdf', '荣安地产：2019社会责任报告-2020年年度报告.pdf', '绿康生化：2019年度社会责任报告-2020年年度报告.pdf', '大禹节水：2020年度社会责任报告-2021年年度报告.pdf', '元力股份：2019年度社会责任报告-2020年年度报告.pdf', '伟星新材：2019年度社会责任报告-2020年年度报告.pdf', '德美化工：2019年年度社会责任报告-2020年年度报告.pdf', '永贵电器：2019年度社会责任报告-2020年年度报告.pdf', '深信服：深信服科技股份有限公司2020年度社会责任报告-2021年年度报告.pdf', '新兴铸管：2019年度社会责任报告-2020年年度报告.pdf', '许继电气：2019年度社会责任报告-2020年年度报告.pdf', '泸州老窖：2019年度社会责任报告-2020年年度报告.pdf', '塔牌集团：2019年度社会责任报告-2020年年度报告.pdf', '领益智造：2020年度企业社会责任报告（英文版）-2021年年度报告.pdf', '温氏股份：2020年度社会责任报告-2021年年度报告.pdf', '上海新阳：2020年度社会责任报告-2021年年度报告.pdf', '雪人股份：社会责任报告-2021年年度报告.pdf', '东方盛虹：2019年社会责任报告-2020年年度报告.pdf', '奥克股份：2019年度社会责任报告-2020年年度报告.pdf', '燕京啤酒：2019年度社会责任报告-2020年年度报告.pdf', '吉林敖东：社会责任报告-2021年年度报告.pdf', '招商港口：2019年企业社会责任报告-2020年年度报告.pdf', '豪迈科技：社会责任报告-2021年年度报告.pdf', '北陆药业：2019年度社会责任报告-2020年年度报告.pdf', '牧原股份：2019年度社会责任报告-2020年年度报告.pdf', '江苏神通：2019年度社会责任报告-2020年年度报告.pdf', '英 力 特：2019年度社会责任报告-2020年年度报告.pdf', '四维图新：2019年度社会责任报告-2020年年度报告.pdf', '爱尔眼科：2020年年度社会责任报告-2021年年度报告.pdf', '华润三九：2019社会责任报告-2020年年度报告.pdf', '张  裕Ａ：2019年度社会责任报告-2020年年度报告.pdf', '宝新能源：2019年度社会责任报告-2020年年度报告.pdf', '国药一致：社会责任报告-2021年年度报告.pdf', '国药一致：社会责任报告-2020年年度报告.pdf', 'TCL 科技：2019年企业社会责任报告-2020年年度报告.pdf', '闽发铝业：社会责任报告-2021年年度报告.pdf', '太阳纸业：社会责任报告-2021年年度报告.pdf', '中光学：2019年度社会责任报告-2020年年度报告.pdf', '申通快递：2019年社会责任报告-2020年年度报告.pdf', '国元证券：社会责任报告-2021年年度报告.pdf', '凯撒旅业：社会责任报告-2021年年度报告.pdf', '江铃汽车：社会责任报告-2021年年度报告.pdf', '中国宝安：社会责任报告-2021年年度报告.pdf', '胜利股份：2019年社会责任报告-2020年年度报告.pdf', '美年健康：社会责任报告（随年报报送）-2021年年度报告.pdf', '欣旺达：欣旺达2020年度企业社会责任报告中文版-2021年年度报告.pdf', '中科三环：2019年度企业社会责任报告-2020年年度报告.pdf', '岳阳兴长：2019年度社会责任报告-2020年年度报告.pdf', '碧水源：2019年度社会责任报告-2020年年度报告.pdf', '富春股份：2020年度社会责任报告-2021年年度报告.pdf', '开尔新材：2020年度社会责任报告-2021年年度报告.pdf', '东北证券：2019年度社会责任报告-2020年年度报告.pdf', '硅宝科技：2020年度社会责任报告-2021年年度报告.pdf', '双成药业：社会责任报告（2019年）-2020年年度报告.pdf', '永高股份：2019年社会责任报告-2020年年度报告.pdf', '大族激光：2019年度社会责任报告-2020年年度报告.pdf', '攀钢钒钛：2019年社会责任报告-2020年年度报告.pdf', '顺鑫农业：社会责任报告-2021年年度报告.pdf', '华东医药：2019年度企业社会责任报告-2020年年度报告.pdf', '新宙邦：2019年度社会责任报告-2020年年度报告.pdf', '三环集团：2019年度社会责任报告-2020年年度报告.pdf', '易事特：2020年度社会责任报告-2021年年度报告.pdf', '郑州银行：社会责任报告-2021年年度报告.pdf', '江特电机：2019年度社会责任报告-2020年年度报告.pdf', '光环新网：2019年度社会责任报告-2020年年度报告.pdf', '同花顺：2020年度社会责任报告-2021年年度报告.pdf', '新华制药：H股公告-2020年社会责任报告-2021年年度报告.pdf', '平潭发展：社会责任报告（随年报报送）-2021年年度报告.pdf', '天桥起重：2019年度社会责任报告-2020年年度报告.pdf', '三聚环保：公司2020年社会责任报告-2021年年度报告.pdf', '汇川技术：2020年度社会责任报告-2021年年度报告.pdf', '卫宁健康：2019年度社会责任报告-2020年年度报告.pdf', '洽洽食品：2019年度社会责任报告-2020年年度报告.pdf', '冰山冷热：2019年度社会责任报告-2020年年度报告.pdf', '海大集团：2019年度社会责任报告-2020年年度报告.pdf', '吉林敖东：2019年度社会责任报告-2020年年度报告.pdf', '达安基因：2019年度社会责任报告-2020年年度报告.pdf', '万  科Ａ：2019年度企业社会责任报告-2020年年度报告.pdf', '招商公路：社会责任报告-2021年年度报告.pdf', '漳州发展：2019年度社会责任报告-2020年年度报告.pdf', '千方科技：2020年度社会责任报告-2021年年度报告.pdf', 'ST浩源：2019年度社会责任报告-2020年年度报告.pdf', '方大集团：2019年社会责任报告-2020年年度报告.pdf', '招商蛇口：2019年社会责任报告-2020年年度报告.pdf', '延华智能：2019年度企业社会责任报告-2020年年度报告.pdf', '新 希 望：2020年度社会责任报告（英文版）-2021年年度报告.pdf', '宏达高科：2019年度社会责任报告-2020年年度报告.pdf', '冀中能源：2019年度社会责任报告-2020年年度报告.pdf', '招商公路：2019年度企业社会责任报告-2020年年度报告.pdf', '紫光股份：社会责任报告-2021年年度报告.pdf', '新 和 成：2019年度社会责任报告-2020年年度报告.pdf', '松芝股份：社会责任报告-2021年年度报告.pdf', '宏川智慧：2020年度社会责任报告（英文）-2021年年度报告.pdf', '山西证券：2019年度社会责任报告-2020年年度报告.pdf', '永安林业：2019年度社会责任报告-2020年年度报告.pdf', '新 希 望：2019年度社会责任报告（英文版）-2020年年度报告.pdf', '徐工机械：2019年度社会责任报告-2020年年度报告.pdf', '立讯精密：社会责任报告（随年报报送）-2021年年度报告.pdf', '国星光电：2019年度社会责任报告-2020年年度报告.pdf', '格力电器：2019年度社会责任报告-2020年年度报告.pdf', '洋河股份：社会责任报告-2021年年度报告.pdf', '五 粮 液：2019年度社会责任报告-2020年年度报告.pdf', '威孚高科：2019年度社会责任报告-2020年年度报告.pdf', '光威复材：2020年度社会责任报告-2021年年度报告.pdf', '昆仑万维：2020年度社会责任报告-2021年年度报告.pdf', '江苏神通：社会责任报告-2021年年度报告.pdf', '博杰股份：社会责任报告-2021年年度报告.pdf', '闽发铝业：2019年度社会责任报告-2020年年度报告.pdf', '中原传媒：中原传媒2020年度社会责任报告-2021年年度报告.pdf', '佛燃能源：2019年社会责任报告-2020年年度报告.pdf', '沃森生物：2020年度社会责任报告-2021年年度报告.pdf', '大华股份：2019年度社会责任报告-2020年年度报告.pdf', '三钢闽光：2019年度社会责任报告-2020年年度报告.pdf', '中联重科：社会责任报告-2021年年度报告.pdf', '青松股份：2019年度社会责任报告-2020年年度报告.pdf', '雪迪龙：社会责任报告-2021年年度报告.pdf', '华峰氨纶：2019年度社会责任报告-2020年年度报告.pdf', '第一创业：2019年度社会责任报告-2020年年度报告.pdf', '美的集团：美的集团2020年度社会责任报告（英文版）-2021年年度报告.pdf', '星云股份：2019年度社会责任报告-2020年年度报告.pdf', '中天金融：2019年度公司社会责任报告-2020年年度报告.pdf', '中色股份：2019年度社会责任报告-2020年年度报告.pdf', '新兴铸管：社会责任报告-2021年年度报告.pdf', '华数传媒：2019年度企业社会责任报告-2020年年度报告.pdf', '华侨城Ａ：2019年社会责任报告-2020年年度报告.pdf', '山河药辅：山河药辅2020年度社会责任报告-2021年年度报告.pdf', '洽洽食品：社会责任报告-2021年年度报告.pdf', '国海证券：社会责任报告-2021年年度报告.pdf', '山东路桥：2019年度社会责任报告-2020年年度报告.pdf', '首钢股份：2019年度社会责任报告-2020年年度报告.pdf', '好想你：2019年度社会责任报告-2020年年度报告.pdf', '麦格米特：社会责任报告（随年报报送）-2021年年度报告.pdf', '新天科技：2019年度社会责任报告-2020年年度报告.pdf', '科顺股份：2020年社会责任报告-2021年年度报告.pdf', '富春环保：2019年度社会责任报告-2020年年度报告.pdf', '太阳电缆：2019年度社会责任报告-2020年年度报告.pdf', '机器人：2019年度社会责任报告-2020年年度报告.pdf', '宏润建设：2019年度社会责任报告-2020年年度报告.pdf', '华帝股份：2019年社会责任报告-2020年年度报告.pdf', '深振业Ａ：2019年度社会责任报告-2020年年度报告.pdf', '云铝股份：社会责任报告-2021年年度报告.pdf', '惠云钛业：2020年企业社会责任报告-2021年年度报告.pdf', '攀钢钒钛：社会责任报告-2021年年度报告.pdf', '大华股份：社会责任报告-2021年年度报告.pdf', '杰瑞股份：社会责任报告-2021年年度报告.pdf', '宁波银行：2019年度社会责任报告-2020年年度报告.pdf', '华孚时尚：2019年度社会责任报告-2020年年度报告.pdf', '东方钽业：关于公司2019年度社会责任报告-2020年年度报告.pdf', '兴瑞科技：2019年度社会责任报告-2020年年度报告.pdf', '神州泰岳：2019年社会责任报告-2020年年度报告.pdf', '星辉娱乐：2020年度社会责任报告-2021年年度报告.pdf', '中航飞机：2019年度社会责任报告-2020年年度报告.pdf', 'ST盐湖：社会责任报告-2021年年度报告.pdf', '首钢股份：2019年度社会责任报告（英文版）-2020年年度报告.pdf', '凯伦股份：2019年度社会责任报告-2020年年度报告.pdf', '中科信息：2019年度社会责任报告-2020年年度报告.pdf', '万  科Ａ：社会责任报告-2021年年度报告.pdf', '华数传媒：社会责任报告（随年报报送）-2021年年度报告.pdf', '康芝药业：2019年度社会责任报告-2020年年度报告.pdf', '泛海控股：2019年度企业社会责任报告-2020年年度报告.pdf', '利亚德：2019企业社会责任报告-2020年年度报告.pdf', '伊之密：2019年度社会责任报告-2020年年度报告.pdf', '招商港口：2020企业社会责任报告-2021年年度报告.pdf', '中金岭南：2019年度社会责任报告-2020年年度报告.pdf', '神火股份：社会责任报告-2021年年度报告.pdf', '太钢不锈：社会责任报告-2021年年度报告.pdf', '青青稞酒：2020年度社会责任报告-2021年年度报告.pdf', '中信特钢：2020企业社会责任报告-2021年年度报告.pdf', '长江证券：2019年度社会责任报告-2020年年度报告.pdf', '蓝思科技：2019年社会责任报告-2020年年度报告.pdf', '华闻集团：2019年度社会责任报告-2020年年度报告.pdf', '视源股份：2019年社会责任报告-2020年年度报告.pdf', '冀东水泥：社会责任报告-2021年年度报告.pdf', '云铝股份：2019年社会责任报告-2020年年度报告.pdf', '京东方Ａ：2019年企业社会责任报告-2020年年度报告.pdf', '深振业Ａ：社会责任报告-2021年年度报告.pdf', '广发证券：社会责任报告-2021年年度报告.pdf', '中文在线：2019年度社会责任报告-2020年年度报告.pdf', '领益智造：社会责任报告-2021年年度报告.pdf', '荣盛发展：2019公司社会责任报告-2020年年度报告.pdf', '铁汉生态：2019年社会责任报告-2020年年度报告.pdf', '广联达：2019年度社会责任报告-2020年年度报告.pdf', '海亮股份：2019年度社会责任报告-2020年年度报告.pdf', '宁德时代：2020年企业社会责任报告-2021年年度报告.pdf', '掌趣科技：2019年度社会责任报告-2020年年度报告.pdf', '北新建材：社会责任报告-2021年年度报告.pdf', '欣旺达：欣旺达2020年度企业社会责任报告英文版-2021年年度报告.pdf', '鲁  泰Ａ：2019年度社会责任报告-2020年年度报告.pdf', '中油资本：2019年度社会责任报告-2020年年度报告.pdf', '河钢股份：2019年度社会责任报告-2020年年度报告.pdf', '双成药业：社会责任报告-2021年年度报告.pdf', '利民股份：社会责任报告-2021年年度报告.pdf', '汇中股份：2020年年度社会责任报告-2021年年度报告.pdf', '龙蟒佰利：2019年度企业社会责任报告-2020年年度报告.pdf', '红 宝 丽：2019年度社会责任报告-2020年年度报告.pdf', '顺鑫农业：2019年度社会责任报告-2020年年度报告.pdf', '国海证券：2019年度社会责任报告-2020年年度报告.pdf', '宝通科技：宝通科技社会责任报告-2021年年度报告.pdf', '蓝焰控股：2019年度社会责任报告-2020年年度报告.pdf', '大禹节水：2019年度社会责任报告-2020年年度报告.pdf', '网宿科技：2020年度社会责任报告-2021年年度报告.pdf', '上峰水泥：2019年度社会责任报告-2020年年度报告.pdf', '横店东磁：社会责任报告-2021年年度报告.pdf', '元力股份：2020年度社会责任报告-2021年年度报告.pdf', '科大讯飞：社会责任报告-2021年年度报告.pdf', '长春高新：2020年度社会责任报告-2021年年度报告.pdf', '金陵药业：2019年度企业社会责任报告-2020年年度报告.pdf', '宁德时代：2019年度企业社会责任报告-2020年年度报告.pdf', '亚厦股份：2019年度企业社会责任报告-2020年年度报告.pdf', '顺丰控股：2019社会责任报告-2020年年度报告.pdf', '金力永磁：2020年度社会责任报告-2021年年度报告.pdf', '康泰生物：2019年社会责任报告-2020年年度报告.pdf', '汉缆股份：2019年度企业社会责任报告-2020年年度报告.pdf', '欧菲光：2019年度社会责任报告-2020年年度报告.pdf', '招商蛇口：社会责任报告-2021年年度报告.pdf', '棕榈股份：社会责任报告-2020年年度报告.pdf', '东北证券：社会责任报告-2021年年度报告.pdf', '伟星股份：2019年度社会责任报告-2020年年度报告.pdf', '北陆药业：2020年度社会责任报告-2021年年度报告.pdf', '宝新能源：2020年度社会责任报告-2021年年度报告.pdf', '天茂退：2019年度社会责任报告-2020年年度报告.pdf', '荣安地产：社会责任报告-2021年年度报告.pdf', '湖南黄金：2019年度社会责任报告-2020年年度报告.pdf', '苏州固锝：社会责任报告-2021年年度报告.pdf', '比亚迪：2019年社会责任报告-2020年年度报告.pdf', '塔牌集团：2020年度社会责任报告-2021年年度报告.pdf', '永贵电器：2020年度社会责任报告-2021年年度报告.pdf', '鹏鼎控股：2019年社会责任报告-2020年年度报告.pdf', '达刚控股：2020年度社会责任报告-2021年年度报告.pdf', '奥克股份：2020年度社会责任报告-2021年年度报告.pdf', '芭田股份：2019年度社会责任报告-2020年年度报告.pdf', '金禾实业：2019年社会责任报告-2020年年度报告.pdf', '万和电气：2019年度社会责任报告-2020年年度报告.pdf', '上海新阳：2019年度社会责任报告-2020年年度报告.pdf', '立华股份：2020年度社会责任报告-2021年年度报告.pdf', '国脉科技：2019年度社会责任报告-2020年年度报告.pdf', '德生科技：2019年度社会责任报告-2020年年度报告.pdf', '康弘药业：2019社会责任报告-2020年年度报告.pdf', '佐力药业：2020年度社会责任报告-2021年年度报告.pdf', '苏州银行：2019年度社会责任报告-2020年年度报告.pdf', '中能电气：2019年度社会责任报告-2020年年度报告.pdf', '天虹股份：社会责任报告-2021年年度报告.pdf', '光迅科技：2019年度社会责任报告-2020年年度报告.pdf', '圣农发展：社会责任报告-2021年年度报告.pdf', '许继电气：社会责任报告-2021年年度报告.pdf', '科伦药业：2019年度社会责任报告-2020年年度报告.pdf', '恒逸石化：恒逸石化社会责任报告（英文版）-2021年年度报告.pdf', '乐普医疗：2019年度社会责任报告-2020年年度报告.pdf', '首钢股份：北京首钢股份有限公司2020年度社会责任报告（英文版）-2021年年度报告.pdf', '天桥起重：株洲天桥起重机股份有限公司2020年度社会责任报告-2021年年度报告.pdf', '西部证券：2019年社会责任报告-2020年年度报告.pdf', '北新建材：2019年度社会责任报告-2020年年度报告.pdf', '卓胜微：2020年度社会责任报告-2021年年度报告.pdf', '迈瑞医疗：2019年社会责任报告-2020年年度报告.pdf', '华西证券：社会责任报告-2021年年度报告.pdf', '汉威科技：2020年度社会责任报告-2021年年度报告.pdf', '美的集团：2019年社会责任报告-2020年年度报告.pdf', '中国铁物：社会责任报告-2021年年度报告.pdf', '千方科技：2020年度社会责任报告（英文版）-2021年年度报告.pdf', '铁汉生态：2020年公司社会责任报告-2021年年度报告.pdf', '信维通信：2020年度社会责任报告-2021年年度报告.pdf', '中联重科：2019年度社会责任报告-2020年年度报告.pdf', '新野纺织：2019年度社会责任报告-2020年年度报告.pdf', '焦点科技：社会责任报告-2021年年度报告.pdf', '焦点科技：2019年度企业社会责任报告-2020年年度报告.pdf', '圣农发展：2019年度社会责任报告-2020年年度报告.pdf', '中泰化学：2019年度社会责任报告-2020年年度报告.pdf', '国信证券：2019年度社会责任报告-2020年年度报告.pdf', '南洋股份：2019年度社会责任报告-2020年年度报告.pdf', '飞亚达：2019年度企业社会责任报告-2020年年度报告.pdf', '易成新能：2019年社会责任报告-2020年年度报告.pdf', '三特索道：三特索道2020年度社会责任报告-2021年年度报告.pdf', '大洋电机：2019年度社会责任报告-2020年年度报告.pdf', '智飞生物：2019年度社会责任报告-2020年年度报告.pdf', '歌尔股份：2019年度企业社会责任报告-2020年年度报告.pdf', '顶固集创：2020年社会责任报告-2021年年度报告.pdf', '广发证券：2019社会责任报告-2020年年度报告.pdf', '泰达股份：2019年度企业社会责任报告-2020年年度报告.pdf', '盐 田 港：2019年度社会责任报告-2020年年度报告.pdf', '双鹭药业：2019年度社会责任报告-2020年年度报告.pdf', '永利股份：2020年度社会责任报告-2021年年度报告.pdf', '科信技术：2019年度社会责任报告-2020年年度报告.pdf', '爱美客：2020年度企业社会责任报告-2021年年度报告.pdf', '湖北能源：2019年度社会责任报告-2020年年度报告.pdf', '大族激光：社会责任报告-2021年年度报告.pdf', '冰山冷热：社会责任报告-2021年年度报告.pdf', '双汇发展：社会责任报告-2021年年度报告.pdf', '鸿博股份：社会责任报告-2021年年度报告.pdf', '嘉事堂：社会责任报告-2021年年度报告.pdf', '新文化：2019年度社会责任报告-2020年年度报告.pdf', '老板电器：2019年度社会责任报告-2020年年度报告.pdf', '国脉科技：社会责任报告-2021年年度报告.pdf', '太阳纸业：2019年度社会责任报告-2020年年度报告.pdf', '长城证券：2020年度社会责任报告-2021年年度报告.pdf', '安洁科技：2019年度社会责任报告-2020年年度报告.pdf', '奇正藏药：2019年社会责任报告-2020年年度报告.pdf', 'ST永林：社会责任报告（随年报报送）-2021年年度报告.pdf', '先导智能：无锡先导智能装备股份有限公司2020年度社会责任报告-2021年年度报告.pdf', '精功科技：2020年度社会责任报告-2021年年度报告.pdf', '金龙鱼：2020年度社会责任报告-2021年年度报告.pdf', '云南能投：社会责任报告-2021年年度报告.pdf', '锦龙股份：社会责任报告-2021年年度报告.pdf', '飞凯材料：2019年度社会责任报告-2020年年度报告.pdf', '北化股份：2019年度社会责任报告-2020年年度报告.pdf', '恒逸石化：2019年度社会责任报告-2020年年度报告.pdf', '深天马Ａ：2019年企业社会责任报告-2020年年度报告.pdf', '科安达：2019年社会责任报告-2020年年度报告.pdf', '众合科技：2019年度社会责任报告-2020年年度报告.pdf', '盐津铺子：社会责任报告-2021年年度报告.pdf', '美邦服饰：2019年度社会责任报告-2020年年度报告.pdf', '恒逸石化：2019年度社会责任报告（英文版）-2020年年度报告.pdf', '福晶科技：2019年度社会责任报告-2020年年度报告.pdf', '赣锋锂业：社会责任报告-2021年年度报告.pdf', '江阴银行：社会责任报告-2021年年度报告.pdf', '正邦科技：2019年度社会责任报告-2020年年度报告.pdf', '天茂集团：2019年度社会责任报告-2020年年度报告.pdf', '电广传媒：2019年度社会责任报告-2020年年度报告.pdf', '古井贡酒：2019年度社会责任报告-2020年年度报告.pdf', '国信证券：社会责任报告-2021年年度报告.pdf', '视源股份：2020年社会责任报告（英文版）-2021年年度报告.pdf', '上海凯宝：2020年度社会责任报告-2021年年度报告.pdf', '华谊兄弟：2019年社会责任报告-2020年年度报告.pdf', '深信服：2019年度社会责任报告-2020年年度报告.pdf', '银宝山新：2019年社会责任报告-2020年年度报告.pdf', '荣盛石化：2020年社会责任报告-2021年年度报告.pdf', '华侨城Ａ：社会责任报告-2021年年度报告.pdf', '铜陵有色：社会责任报告（随年报报送）-2021年年度报告.pdf', '联发股份：2019年度社会责任报告-2020年年度报告.pdf', '金岭矿业：社会责任报告-2021年年度报告.pdf', '翔丰华：2020年度社会责任报告-2021年年度报告.pdf', '巴安水务：2019年度社会责任报告-2020年年度报告.pdf', '中原环保：2019年度社会责任报告-2020年年度报告.pdf', '海格通信：2019年度社会责任报告-2020年年度报告.pdf', '广联达：2020年度社会责任报告(英文版)-2021年年度报告.pdf', '星网锐捷：2019年社会责任报告-2020年年度报告.pdf', '金陵药业：企业社会责任报告-2021年年度报告.pdf', '海 利 得：2019年社会责任报告-2020年年度报告.pdf', '深圳能源：2019年度社会责任报告-2020年年度报告.pdf', '鲁  泰Ｂ：社会责任报告（英文版）-2021年年度报告.pdf', '远 望 谷：2019企业社会责任报告-2020年年度报告.pdf', '上海莱士：2020年度社会责任报告-2021年年度报告.pdf', '天源迪科：2020年企业社会责任报告-2021年年度报告.pdf', '金岭矿业：2019年度社会责任报告-2020年年度报告.pdf', '皖通科技：2019年度社会责任报告-2020年年度报告.pdf', '回盛生物：2020年社会责任报告-2021年年度报告.pdf', '蓝色光标：2021年半年度企业社会责任报告-2021年年度报告.pdf', '景兴纸业：2019年度企业社会责任报告-2020年年度报告.pdf', '东旭光电：2019年度企业社会责任报告-2020年年度报告.pdf', '中环股份：2019年度社会责任报告-2020年年度报告.pdf', '滨江集团：2019年度社会责任报告-2020年年度报告.pdf', '迈瑞医疗：2020年度社会责任报告-2021年年度报告.pdf', '乐歌股份：乐歌人体工学科技股份有限公司2020年度社会责任报告-2021年年度报告.pdf', '联化科技：2019年度社会责任报告-2020年年度报告.pdf', '亚厦股份：社会责任报告（随年报报送）-2021年年度报告.pdf']

for li in pdfList:
    if li.endswith('.pdf'):
        pdfpath = path + '/' + li
        print(pdfpath)
        pdf = pdfplumber.open(pdfpath)
        print(pdf.pages)  # 查看是否能将pdf文件顺利打开

        # 直接提取所有的text也可以！先把2页text合并在处理。合并后将每一行打印出来看看效果，并思考如何提取需要的信息：
        pages = len(pdf.pages)
        str = re.sub('.pdf', '.txt', li)
        print(str)
        file1 = '/Users/bytedance/Documents/年报/深交所-年报/txt文件' + str  # txt2（需更改为自己的）--自己创建一个存放txt文件的文件夹
        f = open(file1, 'a')  # 读取label.txt文件，没有则创建，‘a’表示再次写入时不覆盖之前的内容
        for i in range(1, pages):
            all_text = pdf.pages[0].extract_text() + pdf.pages[i].extract_text()
            f.write(all_text)
            f.write('\n')
        all_text.split('\n')







